<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>사용자 페이지</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        /* Add any styling you need */
    </style>
</head>
<body>
    <h1>신청완료</h1>
    <div id="message">
        <!-- Success or error message will be displayed here -->
    </div>
    <script>
        function getRaceNumber() {
          $.ajax({
            url: "https://kraserver.pythonanywhere.com/get_race_number",
            type: "GET",
            success: function (response) {
              const raceNumber = response.race_number;
              // Store the raceNumber in a global variable or a hidden input field
            },
            error: function (error) {
              console.error("Error fetching race_number:", error);
            },
          });
        }
        function registerTable(tableNumber, raceNumber) {
          $.ajax({
            url: "https://kraserver.pythonanywhere.com/register_table",
            type: "POST",
            data: {
              table_number: tableNumber,
              race_number: raceNumber,
            },
            success: function (response) {
              // Include the raceNumber in the success message
              $('#message').html(`<p>${raceNumber} 경주 테이블 번호가 정상 등록되었습니다.</p>`);
            },
            error: function (error) {
              console.error("Error registering table:", error);
              alert("테이블 번호 등록에 실패했습니다.");
            },
          });
        }

        // Get the table number from the URL and register it
        const urlParams = new URLSearchParams(window.location.search);
        const tableNumber = urlParams.get('table');
        if (tableNumber) {
            getRaceNumber();
        } else {
            $('#message').html('<p>테이블 번호가 없습니다.</p>');
        }


    </script>
</body>
</html>
