<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.min.js"></script>
    <script>
        const socket = io('https://kraserver.pythonanywhere.com');

        function refreshTableList() {
            fetch('https://kraserver.pythonanywhere.com/registered_tables')
                .then(response => response.json())
                .then(data => {
                    const tableList = document.getElementById('table-list');
                    tableList.innerHTML = '';

                    data.forEach(tableNumber => {
                        const listItem = document.createElement('li');
                        listItem.textContent = `Table No. ${tableNumber}`;
                        tableList.appendChild(listItem);
                    });
                });

            fetch('https://kraserver.pythonanywhere.com/total_requests')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('total-count').textContent = `Total Count: ${data}`;
                });
        }

        socket.on('table_registered', () => {
            refreshTableList();
        });

        refreshTableList();
    </script>
</head>
<body>
    <h1>Admin Dashboard</h1>
    <h2 id="total-count">Total requests: 0</h2>
    <ul id="table-list"></ul>
</body>
</html>
