<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <script>
        function refreshTableList() {
            // Fetch the registered table numbers from the server
            fetch('https://kraserver.pythonanywhere.com/registered_tables')
                .then(response => response.json())
                .then(data => {
                    // Update the table list on the page
                    const tableList = document.getElementById('table-list');
                    tableList.innerHTML = '';

                    data.forEach(tableNumber => {
                        const listItem = document.createElement('li');
                        listItem.textContent = `Table: ${tableNumber}`;
                        tableList.appendChild(listItem);
                    });
                });
        }

        // Refresh the table list every 5 seconds
        setInterval(refreshTableList, 5000);

        document.getElementById('race-form').addEventListener('submit', (event) => {
            event.preventDefault();
            const raceNumber = document.getElementById('race-number').value;

            fetch('https://kraserver.pythonanywhere.com/submit_race_number', {
                method: 'POST',
                body: new FormData(event.target)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Race number submitted successfully');
                } else {
                    alert('Submission failed');
                }
            });
        });
    </script>
</head>
<body onload="refreshTableList()">
    <h1>Admin Dashboard</h1>
    <form id="race-form">
        <label for="race-number">Race number:</label>
        <input type="text" id="race-number" name="race-number">
        <button type="submit">Submit</button>
    </form>
    <ul id="table-list"></ul>
</body>
</html>
