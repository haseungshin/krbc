<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <script>
        function refreshTableList() {
            // Fetch the registered table numbers from the server
            fetch('https://kraserver.pythonanywhere.com/registered_tables')
                .then(response => response.json())
                .then(data => {
                    console.log('Registered tables data:', data); // Added console log
                    // Update the table list on the page
                    const tableList = document.getElementById('table-list');
                    tableList.innerHTML = '';

                    data.forEach(tableNumber => {
                        const listItem = document.createElement('li');
                        listItem.textContent = `Table No. ${tableNumber}`;
                        tableList.appendChild(listItem);
                    });

                    // Fetch the total requests count from the server
                    return fetch('https://kraserver.pythonanywhere.com/total_requests');
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Total requests data:', data); // Added console log
                    document.getElementById('total-count').textContent = `Total Count: ${data}`;
                })
                .finally(() => {
                    // Refresh the table list and total request count after 5 seconds
                    setTimeout(refreshTableList, 5000);
                });
        }

        // Call the refreshTableList function initially
        refreshTableList();
    </script>
</head>
<body>
    <h1>Admin Dashboard</h1>
    <h2 id="total-count">Total requests: 0</h2>
    <ul id="table-list"></ul>
</body>
</html>
